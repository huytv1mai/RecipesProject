@{
    ViewData["Title"] = "Account Management";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}

<div class="content-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">Account Management</h4>
                    <p>Welcome, @User.Identity.Name!</p>
                    <p>Role: Administrator</p>
                    <p>Email: admin@example.com</p>
                    <p id="lastLogin">Last login: <span id="lastLoginTime"></span></p>
                    <!-- Form for updating account information -->
                    <form id="updateAccountForm">
                        <div class="form-group">
                            <label for="fullName">Full Name:</label>
                            <input type="text" class="form-control" id="fullName" name="fullName" value="Admin" readonly>
                        </div>
                        <button type="button" class="btn btn-primary" onclick="enableEdit()">Edit</button>
                    </form>
                    <form id="changePasswordForm" style="display: none;">
                        <div class="form-group">
                            <label for="currentPassword">Current Password:</label>
                            <input type="password" class="form-control" id="currentPassword" name="currentPassword">
                        </div>
                        <div class="form-group">
                            <label for="newPassword">New Password:</label>
                            <input type="password" class="form-control" id="newPassword" name="newPassword">
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password:</label>
                            <input type="password" class="form-control" id="confirmPassword" name="confirmPassword">
                        </div>
                        <button type="button" class="btn btn-primary" onclick="updatePassword()">Change Password</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Update last login time using JavaScript
        function updateLastLoginTime() {
            var lastLoginTimeElement = document.getElementById("lastLoginTime");
            var currentDate = new Date();
            var formattedDate = currentDate.toLocaleString();
            lastLoginTimeElement.textContent = formattedDate;
        }

        // Call the function to update last login time
        updateLastLoginTime();

        // Function to enable editing of full name
        function enableEdit() {
            var fullNameInput = document.getElementById("fullName");
            fullNameInput.removeAttribute("readonly");
        }

        // Function to show change password form and hide account update form
        function showChangePasswordForm() {
            document.getElementById("updateAccountForm").style.display = "none";
            document.getElementById("changePasswordForm").style.display = "block";
        }

        // Function to update password
        function updatePassword() {
            var currentPassword = document.getElementById("currentPassword").value;
            var newPassword = document.getElementById("newPassword").value;
            var confirmPassword = document.getElementById("confirmPassword").value;

            // Perform validation for password fields
            if (newPassword !== confirmPassword) {
                alert("New password and confirm password do not match.");
                return;
            }

            // Perform AJAX request to update password
            // Here you can send the data to your backend controller for processing
            // For demonstration purposes, we'll simply log the values to the console
            console.log("Current Password: " + currentPassword);
            console.log("New Password: " + newPassword);
            console.log("Confirm Password: " + confirmPassword);

            // Clear the password fields after updating
            document.getElementById("currentPassword").value = "";
            document.getElementById("newPassword").value = "";
            document.getElementById("confirmPassword").value = "";

            // Hide change password form and show account update form again
            document.getElementById("changePasswordForm").style.display = "none";
            document.getElementById("updateAccountForm").style.display = "block";
        }
    </script>
}
